<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>FSKSM E-Learning Site</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="assets/logo-2.png"/>
        <!-- Bootstrap icons-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />	
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-route.js"></script>
		
		
	</head>
	<body class="d-flex flex-column h-100">
    <main class="flex-shrink-0">
    	<!-- Navigation-->
            <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top">
                <div class="container px-7">
                    <a class="navbar-brand" href="home.html" style="font-size: 20px">
						<img src="assets/logo-2.png" alt="logo" style="width: 55px" >  FSKSM E-Learning</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                            <li class="nav-item"><a class="nav-link" href="home.html">Home</a></li>
                            <li class="nav-item"><a class="nav-link" href="sessem.html">Session & Semester</a></li>
							<li class="nav-item"><a class="nav-link active" href="curriculum.html">Curriculum</a></li>
                            <li class="nav-item"><a class="nav-link" href="course.html">Course</a></li>
                            <li class="nav-item"><a class="nav-link" href="lecturer.html">Lecturer</a></li>
							<li class="nav-item"><a class="nav-link" href="student.html">Student</a></li>
							<li class="nav-item"><a class="nav-link" href="space.html">Space</a></li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" id="navbarDropdownBlog" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">User</a>
                                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdownBlog">
                                    <li><a class="dropdown-item" href="timetable.html">Timetable</a></li>
									<li><a class="dropdown-item" href="user.html">Logout</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
		    <!-- Page content-->
					<section class="breadcrumbs">
						  <div class="container">
							<ol>
							  <li>FSKSM</li>
							  <li>Curriculum</li>
							</ol>
							<h3>List of Curriculum</h3>

						  </div>
						</section>

						<section class="inner-page">
						  <div class="container" data-aos="fade-up">
            <section class="py-5" ng-app="curriculum">
                <div class="container" ng-controller="listCurri">
					<div class="row-cols-lg-auto justify-content-center">
						<div class="col">
						<!-- Content-->
							<div class="table-responsive-md justify-content-center align-items-center text-center">
								<select class="form-select" aria-label="" ng-change= "update()" ng-model = "sesi" required style="width: 130px">
								  	<option value="" disabled>Session</option>
								  	<option value="2020/2021">2020/2021</option>
									<option value="2017/2018">2017/2018</option>
									<option value="2016/2017">2016/2017</option>
									<option value="2015/2016">2015/2016</option>
									<option value="2014/2015">2014/2015</option>
									<option value="2010/2011">2010/2011</option>
									<option value="2008/2009">2008/2009</option>
									<option value="2007/2008">2007/2008</option>
									<option value="2006/2007">2006/2007</option>
									<option value="2005/2006">2005/2006</option>
									<option value="2003/2004">2003/2004</option>
									<option value="2002/2003">2002/2003</option>
								</select>
							</div>
							<div class="row">&nbsp;</div>
							<div class="table-responsive-md justify-content-center align-items-center">
								<table class="table table-bordered table-hover">
								<thead class="table-dark">
						<tr>
							<th class="text-center">Name</th>
							<th class="text-center">Code</th>
							<th class="text-center">Session</th>
							<th class="text-center">Semester</th>
							<th class="text-center">Year</th>
							
						</tr>
						</thead>
						<tbody>
						<tr class="data" ng-repeat="item in data">
							<td class="nama_kurikulum">{{ item.nama_kurikulum }}</td>
							<td class="kod_kurikulum text-center">{{ item.kod_kurikulum }}</td>
							<td class="sesi text-center">{{ item.sesi_masuk }}</td>
							<td class="semester text-center">{{ item.semester_masuk }}</td>
							<td class="tahun text-center">{{ item.tahun_masuk }}</td>
						</tr>
						</tbody>
					</table>
					</div>
						
							<div class="row">&nbsp;</div>
					 		</div>
                 		</div>
					</div>		
				</section>
			</div>
		   </section>
		</main>

      <!-- Footer-->
        <footer class="bg-dark py-4 mt-auto">
            <div class="container px-5">
                <div class="row align-items-center justify-content-between flex-column flex-sm-row">
                    <div class="col-auto"><div class="small m-0 text-white">&copy; 2022 Gamma. All Right Reserved</div></div>
                    <div class="col-auto">
						<a class="link-light small" href="mailto:ttms@fc.utm.my">Contact</a>
                    </div>
                </div>
            </div>
        </footer>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
		
    </body>
</html>
<script>

    // Create Angular JS app. instance
    var app = angular.module('curriculum', []);

    // Register controller 
    app.controller(
        'listCurri',
        function ($scope, $http) {
            $scope.data; // JSON array instance from JSON Web service
            $scope.page_data; // current page array data sliced from $scope.data 
            $scope.page_no = 1; // current page number
            $scope.page_rows = 10; // number of rows per-page
            $scope.page_total; // number of available pages
            $scope.pages; // number of page array
			$scope.sesi;

            $scope.search;
            $scope.data_filtered;

            var ajax = $http({
                method: "GET",
                url: "http://web.fc.utm.my/ttms/web_man_webservice_json.cgi?entity=kurikulum&cohort=2017/2018"
            });
			
			
            ajax.then(
                function success(res) { ajaxSuccess(res) },
                function error(res) { ajaxError(res) }
            );

            function ajaxSuccess(res) {
                //console.log(res.data);
                $scope.data = res.data;
                $scope.applyFilter();
            }

            function ajaxError(res) {
                //console.log(res);
                alert("AJAX connection error!");
            }

            
            
            $scope.applyFilter = function () {
                console.log("Apply filter");
                const regex = new RegExp($scope.search, 'i');
                
                $scope.data_filtered = $scope.data.filter(function (el) {
                        
                        if (el.kod_subjek.match(regex)) { return true; }
                        if (el.nama_subjek.match(regex)) { return true; }
                        return false;
                });
                console.log($scope.data);
                console.log($scope.data_filtered);
                
                countPage();
                $scope.goPage($scope.page_no);
					
            }
			$scope.update = function () {
			var ajax = $http({
                method: "GET",
                url: "http://web.fc.utm.my/ttms/web_man_webservice_json.cgi?entity=kurikulum&cohort="+ $scope.sesi
            });
			
			
            ajax.then(
                function success(res) { ajaxSuccess(res) },
                function error(res) { ajaxError(res) }
            );

            function ajaxSuccess(res) {
                //console.log(res.data);
                $scope.data = res.data;
                $scope.applyFilter();
            }

            function ajaxError(res) {
                //console.log(res);
                alert("AJAX connection error!");
            }

			}
        }
    );

</script>